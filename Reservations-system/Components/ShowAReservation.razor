@inject IJSRuntime JSRuntime

<h4>Gæsteinfo</h4>
@if (ShowThis != null)
{
    <div>
        <p>
            Navn: @ShowThis.Guest.Name
        </p>
        <p>
            TelefonNummer: @ShowThis.Guest.PhoneNumber
        </p>
        <p>
            Mail: @ShowThis.Guest.Mail
        </p>
    </div>
    <h4>
        Reservations info
    </h4>
    <div>
        <p>
            Reservations periode
        </p>
        <p>
            @ShowThis.ReservationPeriod()
        </p>
    </div>
        @if (ShowThis.Confirmed == false)
        {
            <p>
                <button class="btn btn-primary" @onclick="Confirme">Bekræft</button>
            </p>
        }

        <p>
            <button class="btn btn-primary" @onclick="DeleteReservation">@(ShowThis.Confirmed == true? "Slet":"Annuller")</button>
            <button class="btn btn-primary" @onclick="ChangeEditMode">Rediger</button>
        </p>
}

@code {
    [Parameter]
    public bool EditMode { get; set; }

    [Parameter]
    public EventCallback<bool> EditModeChanged { get; set; }

    public async Task ChangeEditMode()
    {
        await EditModeChanged.InvokeAsync(!EditMode);
    }


    [Parameter]
    public Reservation ShowThis { get; set; }

    [Parameter]
    public EventCallback<Reservation> ShowThisChanged { get; set; }

    async Task DeleteReservation()
    {
        if (!await JSRuntime.InvokeAsync<bool>("confirm", "Er du sikker på at du vil slette denne reservation?"))
            return;

        ShowThis = null;
        //Delete from DB
        await ShowThisChanged.InvokeAsync(ShowThis);

    }

    async Task Confirme()
    {
        if (!await JSRuntime.InvokeAsync<bool>("confirm", "Er du sikker på at du vil bekræfte denne reservation?"))
            return;

        ShowThis.Confirmed = true;
        await ShowThisChanged.InvokeAsync(ShowThis);

    }
}
